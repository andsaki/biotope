# Biotope ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

Reactã€TypeScriptã€Three.jsã‚’ä½¿ç”¨ã—ãŸãƒ“ã‚ªãƒˆãƒ¼ãƒ—ç’°å¢ƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

ğŸŒ **Live Demo**: https://biotope.pages.dev/

## ä¸»ãªæ©Ÿèƒ½

- **3Dãƒ“ã‚ªãƒˆãƒ¼ãƒ—ç’°å¢ƒ**: Three.js + React Three Fiberã«ã‚ˆã‚‹æ²¡å…¥å‹3Dç’°å¢ƒ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ™‚è¨ˆ**: æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã¨é€£å‹•ã—ãŸæ˜¼å¤œã‚µã‚¤ã‚¯ãƒ«
- **å‹•çš„ç…§æ˜**: å®Ÿæ™‚é–“ã«å¿œã˜ãŸå¤ªé™½ã®ä½ç½®ã¨ç…§æ˜å¤‰åŒ–
- **å­£ç¯€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ**:
  - **æ˜¥**: æ¡œã®èŠ±ã³ã‚‰
  - **å¤**: é™½ç‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€å¼·ã„æ—¥å·®ã—
  - **ç§‹**: ç´…è‘‰ã®è½ã¡è‘‰ï¼ˆ7è‰²ï¼‰
  - **å†¬**: é›ªã€å†·ãŸã„ç…§æ˜
- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¦ç´ **:
  - æ°´é¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
  - æ—¥æ™‚è¨ˆï¼ˆå½±ã®å‹•ãï¼‰
  - æ¼‚æµã™ã‚‹ç“¶ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å­£ç¯€ã®ä¾¿ç®‹è¡¨ç¤ºï¼‰
  - é¢¨å‘ãã‚³ãƒ³ãƒ‘ã‚¹
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: PC/ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React 19 + TypeScript
- **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«**: Vite 7
- **3Dæç”»**: Three.js + @react-three/fiber + @react-three/drei
- **ç‰©ç†ã‚¨ãƒ³ã‚¸ãƒ³**: @react-three/rapier
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Cloudflare Pages
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Cloudflare R2

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³:
   ```bash
   git clone git@github.com:andsaki/biotope.git
   cd biotope-project
   ```

2. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:
   ```bash
   npm install
   ```

3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•:
   ```bash
   npm run dev
   ```

4. ãƒ“ãƒ«ãƒ‰:
   ```bash
   npm run build
   ```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
src/
â”œâ”€â”€ components/          # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ FishManager.tsx      # é­šã®ç®¡ç†
â”‚   â”œâ”€â”€ Ground.tsx           # åœ°é¢
â”‚   â”œâ”€â”€ WaterSurface.tsx     # æ°´é¢
â”‚   â”œâ”€â”€ DriftingBottle.tsx   # æ¼‚æµã™ã‚‹ç“¶
â”‚   â”œâ”€â”€ SeasonalEffects.tsx  # å­£ç¯€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆçµ±åˆ
â”‚   â”œâ”€â”€ Sun.tsx              # å¤ªé™½
â”‚   â”œâ”€â”€ SceneLights.tsx      # ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°
â”‚   â””â”€â”€ UI.tsx               # ãƒ¡ã‚¤ãƒ³UI
â”œâ”€â”€ hooks/               # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ useRealTime.ts       # æ—¥æœ¬æ™‚é–“ç®¡ç†
â”‚   â”œâ”€â”€ useWindDirection.ts  # é¢¨å‘ãç®¡ç†
â”‚   â””â”€â”€ useLoader.ts         # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç®¡ç†
â”œâ”€â”€ contexts/            # çŠ¶æ…‹ç®¡ç†
â”‚   â””â”€â”€ SeasonContext.tsx    # å­£ç¯€ç®¡ç†
â”œâ”€â”€ utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ sunPosition.ts       # å¤ªé™½ä½ç½®è¨ˆç®—
â”œâ”€â”€ constants.ts         # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å®šæ•°
â””â”€â”€ assets/              # é™çš„è³‡ç”£ï¼ˆR2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾è±¡ï¼‰
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ã‚³ãƒ¼ãƒ‰åˆ†å‰²
`React.lazy` ã¨ `Suspense` ã§é‡ã„3Dã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é…å»¶èª­ã¿è¾¼ã¿ã€‚

### React.memo
ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¡ãƒ¢åŒ–ã—ã¦ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é˜²æ­¢ã€‚

### ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°åŠ¹ç‡åŒ–
- **FishManager**: refãƒ™ãƒ¼ã‚¹ã®æ™‚é–“ç®¡ç†ã§è¨ˆç®—å‰Šæ¸›
- **ParticleLayer**: æ›´æ–°é »åº¦ã‚’50%å‰Šæ¸›ï¼ˆ2ãƒ•ãƒ¬ãƒ¼ãƒ ã«1å›ï¼‰

### Viteãƒ“ãƒ«ãƒ‰æœ€é©åŒ–
```ts
// vite.config.ts
export default defineConfig({
  build: {
    minify: 'esbuild',
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'three-vendor': ['three', '@react-three/fiber', '@react-three/drei', '@react-three/rapier'],
        },
      },
    },
  },
});
```

## CI/CD

### GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

1. **upload-to-r2.yml**: ã‚¢ã‚»ãƒƒãƒˆã‚’Cloudflare R2ã«è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - ã‚¢ã‚»ãƒƒãƒˆå¤‰æ›´æ™‚ã®ã¿å®Ÿè¡Œï¼ˆpathsæŒ‡å®šï¼‰
   - npmã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§Wranglerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«é«˜é€ŸåŒ–
   - ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§10ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ™‚å‡¦ç†
   - Actions v4ã§é«˜é€ŸåŒ–

2. **cache-warm.yml**: æ¯æ—¥15:00 JSTã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¦ã‚©ãƒ¼ãƒ 

### ãƒ‡ãƒ—ãƒ­ã‚¤
Cloudflare Pagesã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã€‚ã‚¢ã‚»ãƒƒãƒˆã¯R2ã‹ã‚‰é…ä¿¡ã€‚

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [`docs/drifting-bottle-feature.md`](docs/drifting-bottle-feature.md): æ¼‚æµã™ã‚‹ç“¶ã®æ©Ÿèƒ½èª¬æ˜
- [`docs/realtime-clock-feature.md`](docs/realtime-clock-feature.md): ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ™‚è¨ˆã®æ©Ÿèƒ½èª¬æ˜
- [`docs/seasonal-effects-feature.md`](docs/seasonal-effects-feature.md): å­£ç¯€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®æ©Ÿèƒ½èª¬æ˜
- [`docs/refactoring-summary.md`](docs/refactoring-summary.md): ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ¦‚è¦

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
