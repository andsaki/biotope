---
description: セッションの内容から ai-guide を自動更新
allowed-tools: Read, Bash(ls:*), Bash(git log:*), Bash(git diff:*), Edit
---

# /update-ai-guide

セッションの内容とコミット履歴から、`docs/ai-guide/` を自動的に更新します。

## 実行手順

### 1. セッションコンテキストから変更内容を把握

最新のセッションディレクトリを特定し、内容を分析：

```bash
!ls -t tmp/ | head -1
```

最新セッションの `plan.md` と `prompt.md` を読み込む：

```
@tmp/XXX_feature/plan.md
@tmp/XXX_feature/prompt.md
```

### 2. 実装した機能や修正内容を抽出

以下の情報を抽出してください：

- **実装した新しいパターン**:
  - 定数管理の手法
  - コンポーネント構造
  - パフォーマンス最適化の手法
  - Three.js/React の使い方

- **遭遇した問題と解決策**:
  - TypeScriptエラーとその解決方法
  - ビルドエラーとその対処法
  - パフォーマンス問題と最適化手法

- **効果的だったプロンプト**:
  - 成功した指示の仕方
  - 具体的な要件の伝え方

### 3. 最近のコミット履歴を確認

```bash
!git log --oneline -n 5
```

変更されたファイルを確認：

```bash
!git diff HEAD~3..HEAD --name-only
```

### 4. 更新が必要な箇所を特定

`docs/ai-guide/` 配下のファイルを読み込んで、以下を判断：

@docs/ai-guide/glossary.md
@docs/ai-guide/architecture.md
@docs/ai-guide/feature.md

- 新しい技術用語が追加された → `glossary.md` に追加
- 新しいアーキテクチャパターンが追加された → `architecture.md` に追加
- 効果的なプロンプトがあった → `feature.md` の「効果的なプロンプト例」に追加
- 問題と解決策があった → `feature.md` の「トラブルシューティング」に追加
- 既存の説明が古くなった → 該当ファイルの該当セクションを更新

### 5. ai-guide を更新

以下の原則に従って更新：

**重要な注意事項**:
- 既存のセクション構造を維持する
- 重複した内容を追加しない（既存の内容と比較）
- マークダウン形式を正しく保つ
- 具体的なコード例を含める
- プロジェクト固有の文脈を含める（「Biotopeプロジェクトでは...」など）

**更新対象のファイルとセクション**:

1. **glossary.md**: 用語集
   - 新しい技術用語（Three.js、React、Cloudflare関連）
   - プロジェクト固有の用語
   - 開発フロー関連の用語

2. **architecture.md**: アーキテクチャとパターン
   - 設計方針の変更
   - 新しいアーキテクチャパターン
   - よくある開発パターンの追加

3. **feature.md**: 機能と開発Tips
   - 新しい開発Tips
   - 効果的なプロンプト例
   - トラブルシューティング

### 6. 更新内容の確認

更新後、以下を確認：

- [ ] マークダウンの構文が正しいか
- [ ] 既存の構造を壊していないか
- [ ] 重複した内容がないか
- [ ] コード例が正しく動作するか

---

## 実行例

```
/update-ai-guide
```

このコマンドは引数なしで実行します。自動的に最新のセッションを分析し、`docs/ai-guide/` 配下の適切なファイルを更新します。

## ファイル構造

```
docs/ai-guide/
├── glossary.md       # 用語集（技術用語、プロジェクト固有の用語）
├── architecture.md   # アーキテクチャとパターン（設計方針、ベストプラクティス）
└── feature.md        # 機能と開発Tips（具体的なTips、プロンプト例、トラブルシューティング）
```
